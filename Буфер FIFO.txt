Буфер FIFO

Два отдельных буфера для счетчика измерения и счетчика АВК

или

Общий буфер для разных режимов




Имеет смысл использовать только один буфер и при переключении режимов очищать его. Необходимо проверить:
1. Как стирать буфер (считыванием содержимого?)
2. Как хранить информацию (для режима измерения достаточно одного буфера, хранящего результаты разности, а для второго режима необходимо хранить результаты счета+ и счета- и важно их не перепутать)
3. Когда необходимо записывать результаты в буфер при режиме измерения (всегда или только по специальной команде начала измерений), когда и с какой частотой считывать данные


Решение вопросов:
1.
2. Напишу про второй режим, потому как для первого и так необходим только один буфер. Измерения одной величины по времени занимает около 2х секунд, всего измерений 8, т.е. измерения довольно продолжительные. Но из-за того, что их немного, то можно их смело хранить в буфере и считать все сразу по окончании измерений. Таким образом решается проблема возможного перемешивания данных при считывании. При этом перед считыванием сначала нужно удостовериться, что измерение на самом деле прошло и мы не потеряем никаких данных. 
3. 






Операции с буфером:
-Разрешить запись результатов в буфер 	(установить wren в 1)
-Считать данные из буфера			   	(установить rden в 1 и по тактовому сигналу SPI выводить данные на выход SPI)
-Очистить буфер 						(установить rden в 1 и подать тактовый сигнал 12 МГц, данные никуда не выводить)